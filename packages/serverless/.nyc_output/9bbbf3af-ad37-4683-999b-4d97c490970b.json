{"/home/guzz/Apps/feathers-micro/packages/serverless/src/get-args.ts":{"path":"/home/guzz/Apps/feathers-micro/packages/serverless/src/get-args.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":25}},"2":{"start":{"line":4,"column":18},"end":{"line":4,"column":38}},"3":{"start":{"line":6,"column":4},"end":{"line":13,"column":22}},"4":{"start":{"line":15,"column":0},"end":{"line":15,"column":26}}},"fnMap":{"0":{"name":"getArgs","decl":{"start":{"line":5,"column":9},"end":{"line":5,"column":16}},"loc":{"start":{"line":5,"column":75},"end":{"line":14,"column":1}},"line":5}},"branchMap":{"0":{"loc":{"start":{"line":5,"column":60},"end":{"line":5,"column":71}},"type":"default-arg","locations":[{"start":{"line":5,"column":69},"end":{"line":5,"column":71}}],"line":5},"1":{"loc":{"start":{"line":10,"column":44},"end":{"line":10,"column":62}},"type":"binary-expr","locations":[{"start":{"line":10,"column":44},"end":{"line":10,"column":54}},{"start":{"line":10,"column":58},"end":{"line":10,"column":62}}],"line":10},"2":{"loc":{"start":{"line":11,"column":43},"end":{"line":11,"column":61}},"type":"binary-expr","locations":[{"start":{"line":11,"column":43},"end":{"line":11,"column":53}},{"start":{"line":11,"column":57},"end":{"line":11,"column":61}}],"line":11},"3":{"loc":{"start":{"line":12,"column":44},"end":{"line":12,"column":62}},"type":"binary-expr","locations":[{"start":{"line":12,"column":44},"end":{"line":12,"column":54}},{"start":{"line":12,"column":58},"end":{"line":12,"column":62}}],"line":12}},"s":{"0":1,"1":1,"2":1,"3":15,"4":1},"f":{"0":15},"b":{"0":[0],"1":[15,6],"2":[15,6],"3":[15,6]},"inputSourceMap":{"version":3,"file":"/home/guzz/Apps/feathers-micro/packages/serverless/src/get-args.ts","sources":["/home/guzz/Apps/feathers-micro/packages/serverless/src/get-args.ts"],"names":[],"mappings":";;;AAAA,uCAA0C;AAU1C,SAAgB,OAAO,CACrB,cAAsB,EACtB,EAAE,KAAK,EAAE,UAAU,EAAE,IAAI,EAAE,MAAM,GAAG,EAAE,EAAkB;IAExD,OAAO;QACL,CAAC,wBAAc,CAAC,IAAI,CAAC,EAAE,iCAAM,MAAM,KAAE,KAAK,IAAG;QAC7C,CAAC,wBAAc,CAAC,GAAG,CAAC,EAAE,CAAC,UAAU,EAAE,MAAM,CAAC;QAC1C,CAAC,wBAAc,CAAC,MAAM,CAAC,EAAE,CAAC,IAAI,EAAE,MAAM,CAAC;QACvC,CAAC,wBAAc,CAAC,MAAM,CAAC,EAAE,CAAC,UAAU,IAAI,IAAI,EAAE,IAAI,kCAAO,MAAM,KAAE,KAAK,IAAG;QACzE,CAAC,wBAAc,CAAC,KAAK,CAAC,EAAE,CAAC,UAAU,IAAI,IAAI,EAAE,IAAI,kCAAO,MAAM,KAAE,KAAK,IAAG;QACxE,CAAC,wBAAc,CAAC,MAAM,CAAC,EAAE,CAAC,UAAU,IAAI,IAAI,kCAAO,MAAM,KAAE,KAAK,IAAG;KACpE,CAAC,cAAc,CAAC,CAAA;AACnB,CAAC;AAZD,0BAYC","sourcesContent":["import { FeathersMethod } from './methods'\nimport { BodyProperties, FeathersMethodValues, Maybe, Query } from './declarations'\n\nexport type GetArgsOptions = {\n  query?: Query\n  feathersId?: Maybe<string>\n  body?: BodyProperties | BodyProperties[]\n  params?: { [key: string]: unknown }\n}\n\nexport function getArgs(\n  feathersMethod: string,\n  { query, feathersId, body, params = {} }: GetArgsOptions\n): unknown {\n  return {\n    [FeathersMethod.FIND]: [{ ...params, query }],\n    [FeathersMethod.GET]: [feathersId, params],\n    [FeathersMethod.CREATE]: [body, params],\n    [FeathersMethod.UPDATE]: [feathersId || null, body, { ...params, query }],\n    [FeathersMethod.PATCH]: [feathersId || null, body, { ...params, query }],\n    [FeathersMethod.REMOVE]: [feathersId || null, { ...params, query }]\n  }[feathersMethod]\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"09a32b191154277c36a82887ae28546843efded3","contentHash":"bb6f8817f05312f526ae3eeab7b14e8325a06f823babcfcd36a0db51994b6fbc"},"/home/guzz/Apps/feathers-micro/packages/serverless/src/methods.ts":{"path":"/home/guzz/Apps/feathers-micro/packages/serverless/src/methods.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":81}},"2":{"start":{"line":4,"column":0},"end":{"line":11,"column":2}},"3":{"start":{"line":12,"column":0},"end":{"line":18,"column":2}},"4":{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},"5":{"start":{"line":21,"column":8},"end":{"line":21,"column":85}},"6":{"start":{"line":23,"column":4},"end":{"line":28,"column":18}},"7":{"start":{"line":30,"column":0},"end":{"line":30,"column":46}}},"fnMap":{"0":{"name":"getFeathersMethod","decl":{"start":{"line":19,"column":9},"end":{"line":19,"column":26}},"loc":{"start":{"line":19,"column":51},"end":{"line":29,"column":1}},"line":19}},"branchMap":{"0":{"loc":{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},{"start":{"line":20,"column":4},"end":{"line":22,"column":5}}],"line":20},"1":{"loc":{"start":{"line":21,"column":15},"end":{"line":21,"column":84}},"type":"cond-expr","locations":[{"start":{"line":21,"column":28},"end":{"line":21,"column":54}},{"start":{"line":21,"column":57},"end":{"line":21,"column":84}}],"line":21}},"s":{"0":1,"1":1,"2":1,"3":1,"4":7,"5":3,"6":4,"7":1},"f":{"0":7},"b":{"0":[3,4],"1":[2,1]},"inputSourceMap":{"version":3,"file":"/home/guzz/Apps/feathers-micro/packages/serverless/src/methods.ts","sources":["/home/guzz/Apps/feathers-micro/packages/serverless/src/methods.ts"],"names":[],"mappings":";;;AAEa,QAAA,cAAc,GAAG;IAC5B,IAAI,EAAE,MAAM;IACZ,GAAG,EAAE,KAAK;IACV,MAAM,EAAE,QAAQ;IAChB,MAAM,EAAE,QAAQ;IAChB,KAAK,EAAE,OAAO;IACd,MAAM,EAAE,QAAQ;CACR,CAAA;AAEG,QAAA,UAAU,GAAG;IACxB,GAAG,EAAE,KAAK;IACV,IAAI,EAAE,MAAM;IACZ,GAAG,EAAE,KAAK;IACV,KAAK,EAAE,OAAO;IACd,MAAM,EAAE,QAAQ;CACR,CAAA;AAEV,SAAgB,iBAAiB,CAAC,UAA4B,EAAE,UAAyB;IACvF,IAAI,UAAU,KAAK,kBAAU,CAAC,GAAG,EAAE;QACjC,OAAO,UAAU,CAAC,CAAC,CAAC,sBAAc,CAAC,GAAG,CAAC,CAAC,CAAC,sBAAc,CAAC,IAAI,CAAA;KAC7D;IAED,OAAO;QACL,CAAC,kBAAU,CAAC,IAAI,CAAC,EAAE,sBAAc,CAAC,MAAM;QACxC,CAAC,kBAAU,CAAC,GAAG,CAAC,EAAE,sBAAc,CAAC,MAAM;QACvC,CAAC,kBAAU,CAAC,KAAK,CAAC,EAAE,sBAAc,CAAC,KAAK;QACxC,CAAC,kBAAU,CAAC,MAAM,CAAC,EAAE,sBAAc,CAAC,MAAM;KAC3C,CAAC,UAAU,CAAC,CAAA;AACf,CAAC;AAXD,8CAWC","sourcesContent":["import { HttpMethodValues, Maybe } from './declarations'\n\nexport const FeathersMethod = {\n  FIND: 'find',\n  GET: 'get',\n  CREATE: 'create',\n  UPDATE: 'update',\n  PATCH: 'patch',\n  REMOVE: 'remove'\n} as const\n\nexport const HttpMethod = {\n  GET: 'GET',\n  POST: 'POST',\n  PUT: 'PUT',\n  PATCH: 'PATCH',\n  DELETE: 'DELETE'\n} as const\n\nexport function getFeathersMethod(httpMethod: HttpMethodValues, feathersId: Maybe<string>) {\n  if (httpMethod === HttpMethod.GET) {\n    return feathersId ? FeathersMethod.GET : FeathersMethod.FIND\n  }\n\n  return {\n    [HttpMethod.POST]: FeathersMethod.CREATE,\n    [HttpMethod.PUT]: FeathersMethod.UPDATE,\n    [HttpMethod.PATCH]: FeathersMethod.PATCH,\n    [HttpMethod.DELETE]: FeathersMethod.REMOVE\n  }[httpMethod]\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"cd1d39d69802347ca8576c79eb52a5e93058fc92","contentHash":"680c93a93cbe947301486c416dc72212c59a254a34df47814d79c63a32587269"},"/home/guzz/Apps/feathers-micro/packages/serverless/src/get-service.ts":{"path":"/home/guzz/Apps/feathers-micro/packages/serverless/src/get-service.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":28}},"2":{"start":{"line":6,"column":22},"end":{"line":8,"column":21}},"3":{"start":{"line":9,"column":21},"end":{"line":9,"column":25}},"4":{"start":{"line":10,"column":18},"end":{"line":10,"column":37}},"5":{"start":{"line":11,"column":4},"end":{"line":17,"column":5}},"6":{"start":{"line":12,"column":8},"end":{"line":12,"column":37}},"7":{"start":{"line":15,"column":8},"end":{"line":15,"column":37}},"8":{"start":{"line":16,"column":8},"end":{"line":16,"column":38}},"9":{"start":{"line":18,"column":4},"end":{"line":24,"column":5}},"10":{"start":{"line":19,"column":8},"end":{"line":19,"column":37}},"11":{"start":{"line":22,"column":8},"end":{"line":22,"column":23}},"12":{"start":{"line":23,"column":8},"end":{"line":23,"column":26}},"13":{"start":{"line":25,"column":4},"end":{"line":25,"column":35}},"14":{"start":{"line":27,"column":0},"end":{"line":27,"column":32}}},"fnMap":{"0":{"name":"getService","decl":{"start":{"line":5,"column":9},"end":{"line":5,"column":19}},"loc":{"start":{"line":5,"column":39},"end":{"line":26,"column":1}},"line":5}},"branchMap":{},"s":{"0":1,"1":1,"2":10,"3":10,"4":10,"5":10,"6":10,"7":5,"8":5,"9":10,"10":10,"11":2,"12":2,"13":10,"14":1},"f":{"0":10},"b":{},"inputSourceMap":{"version":3,"file":"/home/guzz/Apps/feathers-micro/packages/serverless/src/get-service.ts","sources":["/home/guzz/Apps/feathers-micro/packages/serverless/src/get-service.ts"],"names":[],"mappings":";;;AAEA,8DAA8D;AAC9D,SAAgB,UAAU,CACxB,WAAgC,EAChC,IAAY;IAEZ,MAAM,SAAS,GAAG,IAAI;SACnB,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC,gCAAgC;SACnD,KAAK,CAAC,KAAK,CAAC,CAAA;IAEf,IAAI,UAAU,GAAG,IAAI,CAAA;IACrB,IAAI,OAAO,GAAkB,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;IAChD,IAAI;QACF,WAAW,CAAC,OAAO,CAAC,OAAO,CAAC,CAAA;KAC7B;IAAC,OAAO,CAAC,EAAE;QACV,UAAU,GAAG,SAAS,CAAC,GAAG,EAAE,CAAA;QAC5B,OAAO,GAAG,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;KAC9B;IAED,IAAI;QACF,WAAW,CAAC,OAAO,CAAC,OAAO,CAAC,CAAA;KAC7B;IAAC,OAAO,CAAC,EAAE;QACV,OAAO,GAAG,IAAI,CAAA;QACd,UAAU,GAAG,IAAI,CAAA;KAClB;IAED,OAAO,EAAE,OAAO,EAAE,UAAU,EAAE,CAAA;AAChC,CAAC;AAzBD,gCAyBC","sourcesContent":["import { FeathersApplication, Maybe } from './declarations'\n\n// encapsulates the logic to decide the service and feathersId\nexport function getService(\n  feathersApp: FeathersApplication,\n  path: string\n): { service: Maybe<string>; feathersId: Maybe<string> } {\n  const pathArray = path\n    .replace(/^\\//, '') // removes the first / character\n    .split(/\\//g)\n\n  let feathersId = null\n  let service: Maybe<string> = pathArray.join('/')\n  try {\n    feathersApp.service(service)\n  } catch (e) {\n    feathersId = pathArray.pop()\n    service = pathArray.join('/')\n  }\n\n  try {\n    feathersApp.service(service)\n  } catch (e) {\n    service = null\n    feathersId = null\n  }\n\n  return { service, feathersId }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f500f3bab7e08406ab2134ae943716ffc096a66f","contentHash":"31364914303fc5ae170e570b23e4a01ad6b556f5406b486fc4cbc1419fd47550"},"/home/guzz/Apps/feathers-micro/packages/serverless/src/index.ts":{"path":"/home/guzz/Apps/feathers-micro/packages/serverless/src/index.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":19},"end":{"line":15,"column":1}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":126}},"13":{"start":{"line":14,"column":21},"end":{"line":14,"column":126}},"14":{"start":{"line":14,"column":95},"end":{"line":14,"column":126}},"15":{"start":{"line":16,"column":16},"end":{"line":24,"column":1}},"16":{"start":{"line":17,"column":28},"end":{"line":17,"column":110}},"17":{"start":{"line":17,"column":91},"end":{"line":17,"column":106}},"18":{"start":{"line":18,"column":4},"end":{"line":23,"column":7}},"19":{"start":{"line":19,"column":36},"end":{"line":19,"column":97}},"20":{"start":{"line":19,"column":42},"end":{"line":19,"column":70}},"21":{"start":{"line":19,"column":85},"end":{"line":19,"column":95}},"22":{"start":{"line":20,"column":35},"end":{"line":20,"column":100}},"23":{"start":{"line":20,"column":41},"end":{"line":20,"column":73}},"24":{"start":{"line":20,"column":88},"end":{"line":20,"column":98}},"25":{"start":{"line":21,"column":32},"end":{"line":21,"column":116}},"26":{"start":{"line":22,"column":8},"end":{"line":22,"column":78}},"27":{"start":{"line":25,"column":0},"end":{"line":25,"column":62}},"28":{"start":{"line":26,"column":0},"end":{"line":26,"column":28}},"29":{"start":{"line":27,"column":25},"end":{"line":27,"column":52}},"30":{"start":{"line":28,"column":21},"end":{"line":28,"column":44}},"31":{"start":{"line":29,"column":25},"end":{"line":29,"column":52}},"32":{"start":{"line":30,"column":28},"end":{"line":30,"column":68}},"33":{"start":{"line":31,"column":0},"end":{"line":31,"column":49}},"34":{"start":{"line":33,"column":4},"end":{"line":45,"column":7}},"35":{"start":{"line":36,"column":31},"end":{"line":42,"column":18}},"36":{"start":{"line":38,"column":20},"end":{"line":38,"column":33}},"37":{"start":{"line":39,"column":20},"end":{"line":41,"column":21}},"38":{"start":{"line":40,"column":24},"end":{"line":40,"column":101}},"39":{"start":{"line":46,"column":16},"end":{"line":46,"column":27}},"40":{"start":{"line":47,"column":4},"end":{"line":110,"column":7}},"41":{"start":{"line":49,"column":12},"end":{"line":51,"column":13}},"42":{"start":{"line":50,"column":16},"end":{"line":50,"column":36}},"43":{"start":{"line":52,"column":12},"end":{"line":54,"column":15}},"44":{"start":{"line":55,"column":12},"end":{"line":55,"column":24}},"45":{"start":{"line":59,"column":12},"end":{"line":59,"column":86}},"46":{"start":{"line":62,"column":12},"end":{"line":62,"column":40}},"47":{"start":{"line":63,"column":12},"end":{"line":108,"column":15}},"48":{"start":{"line":63,"column":43},"end":{"line":108,"column":14}},"49":{"start":{"line":64,"column":36},"end":{"line":64,"column":107}},"50":{"start":{"line":65,"column":37},"end":{"line":65,"column":42}},"51":{"start":{"line":66,"column":42},"end":{"line":70,"column":17}},"52":{"start":{"line":71,"column":31},"end":{"line":71,"column":99}},"53":{"start":{"line":72,"column":16},"end":{"line":77,"column":17}},"54":{"start":{"line":73,"column":20},"end":{"line":73,"column":98}},"55":{"start":{"line":76,"column":20},"end":{"line":76,"column":41}},"56":{"start":{"line":78,"column":102},"end":{"line":78,"column":108}},"57":{"start":{"line":79,"column":16},"end":{"line":84,"column":17}},"58":{"start":{"line":80,"column":20},"end":{"line":83,"column":23}},"59":{"start":{"line":85,"column":32},"end":{"line":85,"column":57}},"60":{"start":{"line":86,"column":16},"end":{"line":91,"column":17}},"61":{"start":{"line":87,"column":20},"end":{"line":90,"column":23}},"62":{"start":{"line":92,"column":37},"end":{"line":92,"column":134}},"63":{"start":{"line":95,"column":16},"end":{"line":107,"column":19}},"64":{"start":{"line":97,"column":20},"end":{"line":100,"column":23}},"65":{"start":{"line":103,"column":20},"end":{"line":106,"column":23}},"66":{"start":{"line":111,"column":4},"end":{"line":111,"column":54}},"67":{"start":{"line":112,"column":4},"end":{"line":112,"column":15}},"68":{"start":{"line":114,"column":0},"end":{"line":114,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":50},"end":{"line":13,"column":51}},"loc":{"start":{"line":13,"column":71},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":16,"column":44},"end":{"line":16,"column":45}},"loc":{"start":{"line":16,"column":89},"end":{"line":24,"column":1}},"line":16},"5":{"name":"adopt","decl":{"start":{"line":17,"column":13},"end":{"line":17,"column":18}},"loc":{"start":{"line":17,"column":26},"end":{"line":17,"column":112}},"line":17},"6":{"name":"(anonymous_6)","decl":{"start":{"line":17,"column":70},"end":{"line":17,"column":71}},"loc":{"start":{"line":17,"column":89},"end":{"line":17,"column":108}},"line":17},"7":{"name":"(anonymous_7)","decl":{"start":{"line":18,"column":36},"end":{"line":18,"column":37}},"loc":{"start":{"line":18,"column":63},"end":{"line":23,"column":5}},"line":18},"8":{"name":"fulfilled","decl":{"start":{"line":19,"column":17},"end":{"line":19,"column":26}},"loc":{"start":{"line":19,"column":34},"end":{"line":19,"column":99}},"line":19},"9":{"name":"rejected","decl":{"start":{"line":20,"column":17},"end":{"line":20,"column":25}},"loc":{"start":{"line":20,"column":33},"end":{"line":20,"column":102}},"line":20},"10":{"name":"step","decl":{"start":{"line":21,"column":17},"end":{"line":21,"column":21}},"loc":{"start":{"line":21,"column":30},"end":{"line":21,"column":118}},"line":21},"11":{"name":"serverless","decl":{"start":{"line":32,"column":9},"end":{"line":32,"column":19}},"loc":{"start":{"line":32,"column":49},"end":{"line":113,"column":1}},"line":32},"12":{"name":"(anonymous_12)","decl":{"start":{"line":36,"column":16},"end":{"line":36,"column":17}},"loc":{"start":{"line":36,"column":31},"end":{"line":42,"column":18}},"line":36},"13":{"name":"(anonymous_13)","decl":{"start":{"line":36,"column":63},"end":{"line":36,"column":64}},"loc":{"start":{"line":36,"column":76},"end":{"line":42,"column":17}},"line":36},"14":{"name":"(anonymous_14)","decl":{"start":{"line":48,"column":8},"end":{"line":48,"column":9}},"loc":{"start":{"line":48,"column":25},"end":{"line":56,"column":9}},"line":48},"15":{"name":"(anonymous_15)","decl":{"start":{"line":57,"column":8},"end":{"line":57,"column":9}},"loc":{"start":{"line":57,"column":17},"end":{"line":60,"column":9}},"line":57},"16":{"name":"(anonymous_16)","decl":{"start":{"line":61,"column":8},"end":{"line":61,"column":9}},"loc":{"start":{"line":61,"column":18},"end":{"line":109,"column":9}},"line":61},"17":{"name":"(anonymous_17)","decl":{"start":{"line":63,"column":19},"end":{"line":63,"column":20}},"loc":{"start":{"line":63,"column":43},"end":{"line":108,"column":14}},"line":63},"18":{"name":"(anonymous_18)","decl":{"start":{"line":63,"column":75},"end":{"line":63,"column":76}},"loc":{"start":{"line":63,"column":88},"end":{"line":108,"column":13}},"line":63},"19":{"name":"(anonymous_19)","decl":{"start":{"line":96,"column":26},"end":{"line":96,"column":27}},"loc":{"start":{"line":96,"column":36},"end":{"line":101,"column":17}},"line":96},"20":{"name":"(anonymous_20)","decl":{"start":{"line":102,"column":27},"end":{"line":102,"column":28}},"loc":{"start":{"line":102,"column":34},"end":{"line":107,"column":17}},"line":102}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":19},"end":{"line":15,"column":1}},"type":"binary-expr","locations":[{"start":{"line":13,"column":20},"end":{"line":13,"column":24}},{"start":{"line":13,"column":28},"end":{"line":13,"column":45}},{"start":{"line":13,"column":50},"end":{"line":15,"column":1}}],"line":13},"9":{"loc":{"start":{"line":14,"column":21},"end":{"line":14,"column":126}},"type":"if","locations":[{"start":{"line":14,"column":21},"end":{"line":14,"column":126}},{"start":{"line":14,"column":21},"end":{"line":14,"column":126}}],"line":14},"10":{"loc":{"start":{"line":14,"column":25},"end":{"line":14,"column":93}},"type":"binary-expr","locations":[{"start":{"line":14,"column":25},"end":{"line":14,"column":40}},{"start":{"line":14,"column":44},"end":{"line":14,"column":93}}],"line":14},"11":{"loc":{"start":{"line":16,"column":16},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":16,"column":17},"end":{"line":16,"column":21}},{"start":{"line":16,"column":25},"end":{"line":16,"column":39}},{"start":{"line":16,"column":44},"end":{"line":24,"column":1}}],"line":16},"12":{"loc":{"start":{"line":17,"column":35},"end":{"line":17,"column":109}},"type":"cond-expr","locations":[{"start":{"line":17,"column":56},"end":{"line":17,"column":61}},{"start":{"line":17,"column":64},"end":{"line":17,"column":109}}],"line":17},"13":{"loc":{"start":{"line":18,"column":16},"end":{"line":18,"column":34}},"type":"binary-expr","locations":[{"start":{"line":18,"column":16},"end":{"line":18,"column":17}},{"start":{"line":18,"column":22},"end":{"line":18,"column":33}}],"line":18},"14":{"loc":{"start":{"line":21,"column":32},"end":{"line":21,"column":115}},"type":"cond-expr","locations":[{"start":{"line":21,"column":46},"end":{"line":21,"column":67}},{"start":{"line":21,"column":70},"end":{"line":21,"column":115}}],"line":21},"15":{"loc":{"start":{"line":22,"column":51},"end":{"line":22,"column":67}},"type":"binary-expr","locations":[{"start":{"line":22,"column":51},"end":{"line":22,"column":61}},{"start":{"line":22,"column":65},"end":{"line":22,"column":67}}],"line":22},"16":{"loc":{"start":{"line":39,"column":20},"end":{"line":41,"column":21}},"type":"if","locations":[{"start":{"line":39,"column":20},"end":{"line":41,"column":21}},{"start":{"line":39,"column":20},"end":{"line":41,"column":21}}],"line":39},"17":{"loc":{"start":{"line":40,"column":37},"end":{"line":40,"column":100}},"type":"cond-expr","locations":[{"start":{"line":40,"column":85},"end":{"line":40,"column":87}},{"start":{"line":40,"column":90},"end":{"line":40,"column":100}}],"line":40},"18":{"loc":{"start":{"line":40,"column":37},"end":{"line":40,"column":82}},"type":"binary-expr","locations":[{"start":{"line":40,"column":37},"end":{"line":40,"column":65}},{"start":{"line":40,"column":69},"end":{"line":40,"column":82}}],"line":40},"19":{"loc":{"start":{"line":49,"column":12},"end":{"line":51,"column":13}},"type":"if","locations":[{"start":{"line":49,"column":12},"end":{"line":51,"column":13}},{"start":{"line":49,"column":12},"end":{"line":51,"column":13}}],"line":49},"20":{"loc":{"start":{"line":59,"column":19},"end":{"line":59,"column":85}},"type":"cond-expr","locations":[{"start":{"line":59,"column":69},"end":{"line":59,"column":75}},{"start":{"line":59,"column":78},"end":{"line":59,"column":85}}],"line":59},"21":{"loc":{"start":{"line":59,"column":19},"end":{"line":59,"column":66}},"type":"binary-expr","locations":[{"start":{"line":59,"column":19},"end":{"line":59,"column":49}},{"start":{"line":59,"column":53},"end":{"line":59,"column":66}}],"line":59},"22":{"loc":{"start":{"line":79,"column":16},"end":{"line":84,"column":17}},"type":"if","locations":[{"start":{"line":79,"column":16},"end":{"line":84,"column":17}},{"start":{"line":79,"column":16},"end":{"line":84,"column":17}}],"line":79},"23":{"loc":{"start":{"line":79,"column":20},"end":{"line":79,"column":62}},"type":"binary-expr","locations":[{"start":{"line":79,"column":20},"end":{"line":79,"column":32}},{"start":{"line":79,"column":36},"end":{"line":79,"column":62}}],"line":79},"24":{"loc":{"start":{"line":86,"column":16},"end":{"line":91,"column":17}},"type":"if","locations":[{"start":{"line":86,"column":16},"end":{"line":91,"column":17}},{"start":{"line":86,"column":16},"end":{"line":91,"column":17}}],"line":86},"25":{"loc":{"start":{"line":86,"column":20},"end":{"line":86,"column":87}},"type":"binary-expr","locations":[{"start":{"line":86,"column":21},"end":{"line":86,"column":36}},{"start":{"line":86,"column":40},"end":{"line":86,"column":58}},{"start":{"line":86,"column":63},"end":{"line":86,"column":87}}],"line":86},"26":{"loc":{"start":{"line":92,"column":37},"end":{"line":92,"column":134}},"type":"cond-expr","locations":[{"start":{"line":92,"column":72},"end":{"line":92,"column":76}},{"start":{"line":92,"column":79},"end":{"line":92,"column":134}}],"line":92},"27":{"loc":{"start":{"line":92,"column":37},"end":{"line":92,"column":69}},"type":"binary-expr","locations":[{"start":{"line":92,"column":37},"end":{"line":92,"column":50}},{"start":{"line":92,"column":54},"end":{"line":92,"column":69}}],"line":92},"28":{"loc":{"start":{"line":104,"column":36},"end":{"line":104,"column":49}},"type":"binary-expr","locations":[{"start":{"line":104,"column":36},"end":{"line":104,"column":42}},{"start":{"line":104,"column":46},"end":{"line":104,"column":49}}],"line":104}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":1,"13":0,"14":0,"15":1,"16":46,"17":0,"18":38,"19":44,"20":44,"21":0,"22":2,"23":2,"24":1,"25":83,"26":38,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":8,"35":30,"36":30,"37":29,"38":4,"39":8,"40":8,"41":24,"42":8,"43":24,"44":24,"45":259,"46":8,"47":8,"48":8,"49":8,"50":8,"51":8,"52":8,"53":8,"54":8,"55":1,"56":7,"57":7,"58":1,"59":6,"60":6,"61":1,"62":5,"63":5,"64":4,"65":1,"66":8,"67":8,"68":1},"f":{"0":0,"1":0,"2":0,"3":1,"4":38,"5":46,"6":0,"7":38,"8":44,"9":2,"10":83,"11":8,"12":30,"13":30,"14":24,"15":259,"16":8,"17":8,"18":8,"19":4,"20":1},"b":{"0":[1,1,1],"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[0,0],"10":[0,0],"11":[1,1,1],"12":[46,0],"13":[38,38],"14":[37,46],"15":[38,38],"16":[4,25],"17":[0,4],"18":[4,4],"19":[8,16],"20":[0,259],"21":[259,259],"22":[1,6],"23":[7,6],"24":[1,5],"25":[6,1,5],"26":[5,0],"27":[5,5],"28":[1,0]},"inputSourceMap":{"version":3,"file":"/home/guzz/Apps/feathers-micro/packages/serverless/src/index.ts","sources":["/home/guzz/Apps/feathers-micro/packages/serverless/src/index.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AACA,qDAAgD;AAChD,6CAA4C;AAC5C,qDAA0D;AAE1D,qEAAuD;AACvD,iDAA8B;AAE9B,SAAgB,UAAU,CACxB,WAAsC,EACtC,GAAG,WAAyB;IAE5B,WAAW,CAAC,KAAK,CAAC;QAChB,MAAM,EAAE;YACN,GAAG,EAAE;gBACH,CAAO,GAAG,EAAE,IAAI,EAAE,EAAE;;oBAClB,MAAM,IAAI,EAAE,CAAA;oBACZ,IAAI,GAAG,CAAC,MAAM,CAAC,QAAQ,EAAE;wBACvB,GAAG,CAAC,MAAM,GAAG,MAAA,GAAG,CAAC,QAAQ,mCAAI,GAAG,CAAC,MAAM,CAAA;qBACxC;gBACH,CAAC,CAAA;aACF;SACF;KACF,CAAC,CAAA;IACF,MAAM,GAAG,GAAG,WAAuC,CAAA;IACnD,MAAM,CAAC,MAAM,CAAC,GAAG,EAAE;QACjB,GAAG,CAA6B,IAAO,EAAE,KAAW;YAClD,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;gBACnB,IAAI,CAAC,SAAS,GAAG,EAAE,CAAA;aACpB;YAED,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,EAAE;gBAC5B,CAAC,IAAI,CAAC,EAAE,KAAK;aACd,CAAC,CAAA;YAEF,OAAO,IAAI,CAAA;QACb,CAAC;QAED,GAAG,CAAC,GAAW;;YACb,OAAO,MAAA,IAAI,CAAC,SAAS,0CAAG,GAAG,CAAC,CAAA;QAC9B,CAAC;QAED,OAAO;YACL,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAA;YAC3B,OAAO,CAAO,KAAK,EAAE,OAAO,EAAE,EAAE,EAAE,EAAE;gBAElC,MAAM,WAAW,GAAG,MAAM,IAAA,wCAAuB,EAAC,WAAW,EAAE,KAAK,CAAC,CAAA;gBAErE,MAAM,EAAE,QAAQ,EAAE,GAAG,KAAK,CAAA;gBAE1B,MAAM,iBAAiB,GAAG;oBACxB,KAAK;oBACL,EAAE;oBACF,WAAW;iBACZ,CAAA;gBAED,MAAM,MAAM,GAAG,IAAA,8BAAa,EAAC,KAAK,EAAE,WAAW,EAAE,WAAW,CAAC,CAAA;gBAE7D,IAAI;oBACF,MAAM,IAAA,0BAAa,EAAC,iBAAiB,EAAE,MAAM,EAAE,WAAW,CAAC,CAAA;iBAC5D;gBAAC,OAAO,GAAG,EAAE;oBACZ,OAAO,EAAE,CAAC,IAAI,EAAE,GAA4B,CAAC,CAAA;iBAC9C;gBAED,MAAM,EAAE,WAAW,EAAE,MAAM,EAAE,IAAI,EAAE,cAAc,EAAE,iBAAiB,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,CAAA;gBAE5F,IAAI,CAAC,WAAW,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,EAAE;oBAC9C,OAAO,EAAE,CAAC,IAAI,EAAE;wBACd,UAAU,EAAE,GAAG;wBACf,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,KAAK,EAAE,sBAAsB,QAAQ,EAAE,EAAE,CAAC;qBAClE,CAAC,CAAA;iBACH;gBAED,MAAM,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,CAAA;gBAEzC,IAAI,CAAC,CAAC,cAAc,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,EAAE;oBACvE,OAAO,EAAE,CAAC,IAAI,EAAE;wBACd,UAAU,EAAE,GAAG;wBACf,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,KAAK,EAAE,uBAAuB,MAAM,EAAE,EAAE,CAAC;qBACjE,CAAC,CAAA;iBACH;gBAED,MAAM,YAAY,GAAG,IAAI,aAAJ,IAAI,cAAJ,IAAI,GAAI,iCAAM,IAAI,GAAK,KAAK,GAAI,MAAM,CAAC,CAAA;gBAE5D,6DAA6D;gBAC7D,aAAa;gBACb,OAAO,OAAO,CAAC,cAAc,CAAC,CAAC,GAAG,YAAY,CAAC;qBAC5C,IAAI,CAAC,CAAC,IAAoB,EAAE,EAAE;oBAC7B,OAAO,EAAE,CAAC,IAAI,EAAE;wBACd,UAAU,EAAE,GAAG;wBACf,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC;qBAC3B,CAAC,CAAA;gBACJ,CAAC,CAAC;qBACD,KAAK,CAAC,CAAC,CAAoC,EAAE,EAAE;oBAC9C,OAAO,EAAE,CAAC,IAAI,EAAE;wBACd,UAAU,EAAE,CAAC,CAAC,IAAI,IAAI,GAAG;wBACzB,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC,OAAO,EAAE,CAAC;qBAC3C,CAAC,CAAA;gBACJ,CAAC,CAAC,CAAA;YACN,CAAC,CAAA,CAAA;QACH,CAAC;KACa,CAAC,CAAA;IAEjB,GAAG,CAAC,SAAS,CAAC,IAAA,2BAAO,GAAS,CAAC,CAAA;IAE/B,OAAO,GAAG,CAAA;AACZ,CAAC;AAlGD,gCAkGC","sourcesContent":["import { Application, BodyProperties, FeathersApplication, Middleware } from './declarations'\nimport { extractParams } from './extract-params'\nimport { runMiddleware } from './middleware'\nimport { configureAuthentication } from './authentication'\nimport { APIGatewayProxyResult } from 'aws-lambda'\nimport { routing } from '@feathersjs/transport-commons'\nexport * from './declarations'\n\nexport function serverless<S = any, C = any>(\n  feathersApp: FeathersApplication<S, C>,\n  ...middlewares: Middleware[]\n): Application<S, C> {\n  feathersApp.hooks({\n    around: {\n      all: [\n        async (ctx, next) => {\n          await next()\n          if (ctx.params.provider) {\n            ctx.result = ctx.dispatch ?? ctx.result\n          }\n        }\n      ]\n    }\n  })\n  const app = feathersApp as any as Application<S, C>\n  Object.assign(app, {\n    set<L extends keyof C & string>(name: L, value: C[L]) {\n      if (!this.variables) {\n        this.variables = {}\n      }\n\n      Object.assign(this.variables, {\n        [name]: value\n      })\n\n      return this\n    },\n\n    get(key: string) {\n      return this.variables?.[key]\n    },\n\n    handler() {\n      this.emit('handlerstarted')\n      return async (event, context, cb) => {\n\n        const extraParams = await configureAuthentication(feathersApp, event)\n\n        const { resource } = event\n\n        const middlewareContext = {\n          event,\n          cb,\n          feathersApp\n        }\n\n        const params = extractParams(event, feathersApp, extraParams)\n\n        try {\n          await runMiddleware(middlewareContext, params, middlewares)\n        } catch (err) {\n          return cb(null, err as APIGatewayProxyResult)\n        }\n\n        const { serviceName, method, args, feathersMethod, getParamsFromBody, body, query } = params\n\n        if (!serviceName || !this.service(serviceName)) {\n          return cb(null, {\n            statusCode: 404,\n            body: JSON.stringify({ error: `Service not found: ${resource}` })\n          })\n        }\n\n        const service = this.service(serviceName)\n\n        if ((!feathersMethod && !getParamsFromBody) || !service[feathersMethod]) {\n          return cb(null, {\n            statusCode: 404,\n            body: JSON.stringify({ error: `Method not allowed: ${method}` })\n          })\n        }\n\n        const fallbackArgs = args ?? [{ ...body, ...query }, params]\n\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        return service[feathersMethod](...fallbackArgs)\n          .then((data: BodyProperties) => {\n            return cb(null, {\n              statusCode: 200,\n              body: JSON.stringify(data)\n            })\n          })\n          .catch((e: { code: number; message: string }) => {\n            return cb(null, {\n              statusCode: e.code || 500,\n              body: JSON.stringify({ error: e.message })\n            })\n          })\n      }\n    }\n  } as Application)\n\n  app.configure(routing() as any)\n\n  return app\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a3126083a52e070628c3653daed2a5d907414d69","contentHash":"e71acf5a6aa66804abe2913eb468b6336da17282a339930d618923d76614ef49"},"/home/guzz/Apps/feathers-micro/packages/serverless/src/extract-params.ts":{"path":"/home/guzz/Apps/feathers-micro/packages/serverless/src/extract-params.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":31}},"2":{"start":{"line":4,"column":22},"end":{"line":4,"column":46}},"3":{"start":{"line":5,"column":18},"end":{"line":5,"column":38}},"4":{"start":{"line":6,"column":19},"end":{"line":6,"column":40}},"5":{"start":{"line":7,"column":22},"end":{"line":21,"column":1}},"6":{"start":{"line":8,"column":76},"end":{"line":8,"column":81}},"7":{"start":{"line":9,"column":23},"end":{"line":9,"column":67}},"8":{"start":{"line":10,"column":30},"end":{"line":10,"column":98}},"9":{"start":{"line":11,"column":17},"end":{"line":11,"column":65}},"10":{"start":{"line":12,"column":19},"end":{"line":12,"column":69}},"11":{"start":{"line":13,"column":49},"end":{"line":15,"column":50}},"12":{"start":{"line":16,"column":18},"end":{"line":16,"column":86}},"13":{"start":{"line":17,"column":27},"end":{"line":17,"column":108}},"14":{"start":{"line":18,"column":19},"end":{"line":18,"column":73}},"15":{"start":{"line":19,"column":17},"end":{"line":19,"column":93}},"16":{"start":{"line":20,"column":4},"end":{"line":20,"column":101}},"17":{"start":{"line":22,"column":0},"end":{"line":22,"column":38}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":7,"column":22},"end":{"line":7,"column":23}},"loc":{"start":{"line":7,"column":56},"end":{"line":21,"column":1}},"line":7}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":35},"end":{"line":7,"column":51}},"type":"default-arg","locations":[{"start":{"line":7,"column":49},"end":{"line":7,"column":51}}],"line":7},"1":{"loc":{"start":{"line":9,"column":23},"end":{"line":9,"column":67}},"type":"cond-expr","locations":[{"start":{"line":9,"column":38},"end":{"line":9,"column":62}},{"start":{"line":9,"column":65},"end":{"line":9,"column":67}}],"line":9},"2":{"loc":{"start":{"line":10,"column":30},"end":{"line":10,"column":98}},"type":"binary-expr","locations":[{"start":{"line":10,"column":30},"end":{"line":10,"column":51}},{"start":{"line":10,"column":55},"end":{"line":10,"column":75}},{"start":{"line":10,"column":79},"end":{"line":10,"column":98}}],"line":10},"3":{"loc":{"start":{"line":11,"column":17},"end":{"line":11,"column":65}},"type":"cond-expr","locations":[{"start":{"line":11,"column":37},"end":{"line":11,"column":52}},{"start":{"line":11,"column":55},"end":{"line":11,"column":65}}],"line":11},"4":{"loc":{"start":{"line":12,"column":19},"end":{"line":12,"column":69}},"type":"cond-expr","locations":[{"start":{"line":12,"column":39},"end":{"line":12,"column":56}},{"start":{"line":12,"column":59},"end":{"line":12,"column":69}}],"line":12},"5":{"loc":{"start":{"line":13,"column":49},"end":{"line":15,"column":50}},"type":"cond-expr","locations":[{"start":{"line":14,"column":10},"end":{"line":14,"column":68}},{"start":{"line":15,"column":10},"end":{"line":15,"column":50}}],"line":13},"6":{"loc":{"start":{"line":16,"column":18},"end":{"line":16,"column":86}},"type":"binary-expr","locations":[{"start":{"line":16,"column":19},"end":{"line":16,"column":79}},{"start":{"line":16,"column":84},"end":{"line":16,"column":86}}],"line":16},"7":{"loc":{"start":{"line":16,"column":19},"end":{"line":16,"column":79}},"type":"cond-expr","locations":[{"start":{"line":16,"column":39},"end":{"line":16,"column":55}},{"start":{"line":16,"column":58},"end":{"line":16,"column":79}}],"line":16},"8":{"loc":{"start":{"line":17,"column":27},"end":{"line":17,"column":108}},"type":"cond-expr","locations":[{"start":{"line":17,"column":47},"end":{"line":17,"column":53}},{"start":{"line":17,"column":56},"end":{"line":17,"column":108}}],"line":17}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":8,"7":8,"8":8,"9":8,"10":8,"11":8,"12":8,"13":8,"14":8,"15":8,"16":8,"17":1},"f":{"0":8},"b":{"0":[0],"1":[4,4],"2":[8,4,1],"3":[1,7],"4":[1,7],"5":[1,7],"6":[8,1],"7":[1,7],"8":[1,7]},"inputSourceMap":{"version":3,"file":"/home/guzz/Apps/feathers-micro/packages/serverless/src/extract-params.ts","sources":["/home/guzz/Apps/feathers-micro/packages/serverless/src/extract-params.ts"],"names":[],"mappings":";;;AAAA,+CAA0C;AAC1C,uCAA6C;AAC7C,yCAAoC;AAI7B,MAAM,aAAa,GAAG,CAC3B,KAAkC,EAClC,GAAwB,EACxB,cAAqC,EAAE,EACrB,EAAE;IACpB,MAAM,EAAE,UAAU,EAAE,IAAI,EAAE,YAAY,EAAE,IAAI,EAAE,qBAAqB,EAAE,GAAG,KAAK,CAAA;IAC7E,MAAM,UAAU,GAAG,YAAY,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,EAAE,CAAA;IAC/D,MAAM,iBAAiB,GAAG,UAAU,KAAK,MAAM,IAAI,CAAC,CAAC,UAAU,CAAC,OAAO,IAAI,CAAC,CAAC,UAAU,CAAC,MAAM,CAAA;IAC9F,MAAM,IAAI,GAAG,iBAAiB,CAAC,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,UAAU,CAAA;IAC7D,MAAM,MAAM,GAAG,iBAAiB,CAAC,CAAC,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC,UAAU,CAAA;IACjE,MAAM,EAAE,OAAO,EAAE,WAAW,EAAE,UAAU,EAAE,GAAG,iBAAiB;QAC5D,CAAC,CAAC,EAAE,OAAO,EAAE,UAAU,CAAC,OAAO,EAAE,UAAU,EAAE,UAAU,CAAC,EAAE,EAAE;QAC5D,CAAC,CAAC,IAAA,wBAAU,EAAC,GAAG,EAAE,IAAI,CAAC,CAAA;IACzB,MAAM,KAAK,GAAG,CAAC,iBAAiB,CAAC,CAAC,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC,qBAAqB,CAAC,IAAI,EAAE,CAAA;IAClF,MAAM,cAAc,GAAG,iBAAiB,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,IAAA,2BAAiB,EAAC,MAAM,EAAE,UAAU,CAAC,CAAA;IACzF,MAAM,MAAM,mBAAK,OAAO,EAAE,KAAK,CAAC,OAAO,IAAK,WAAW,CAAE,CAAA;IACzD,MAAM,IAAI,GAAG,IAAA,kBAAO,EAAC,cAAc,EAAE,EAAE,KAAK,EAAE,UAAU,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAA;IACzE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,WAAW,EAAE,UAAU,EAAE,KAAK,EAAE,IAAI,EAAE,cAAc,EAAE,iBAAiB,EAAE,CAAA;AAClG,CAAC,CAAA;AAlBY,QAAA,aAAa,iBAkBzB","sourcesContent":["import { getService } from './get-service'\nimport { getFeathersMethod } from './methods'\nimport { getArgs } from './get-args'\nimport { FeathersApplication, ServerlessParams, ServerlessGatewayProxyEvent } from './declarations'\nimport { AuthenticationRequest } from '@feathersjs/authentication/lib'\n\nexport const extractParams = (\n  event: ServerlessGatewayProxyEvent,\n  app: FeathersApplication,\n  extraParams: AuthenticationRequest = {}\n): ServerlessParams => {\n  const { httpMethod, body: bodyAsString, path, queryStringParameters } = event\n  const parsedBody = bodyAsString ? JSON.parse(bodyAsString) : {}\n  const getParamsFromBody = httpMethod === 'POST' && !!parsedBody.service && !!parsedBody.method\n  const body = getParamsFromBody ? parsedBody.data : parsedBody\n  const method = getParamsFromBody ? parsedBody.method : httpMethod\n  const { service: serviceName, feathersId } = getParamsFromBody\n    ? { service: parsedBody.service, feathersId: parsedBody.id }\n    : getService(app, path)\n  const query = (getParamsFromBody ? parsedBody.query : queryStringParameters) || {}\n  const feathersMethod = getParamsFromBody ? method : getFeathersMethod(method, feathersId)\n  const params = { headers: event.headers, ...extraParams }\n  const args = getArgs(feathersMethod, { query, feathersId, body, params })\n  return { body, method, serviceName, feathersId, query, args, feathersMethod, getParamsFromBody }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"054207a5940f2e86b23e0036f6c5ec096c8eda74","contentHash":"1474e8efcc54d2bba5561856de238703fa653cfa11ddc8f6ed646e0aded07d7e"},"/home/guzz/Apps/feathers-micro/packages/serverless/src/middleware.ts":{"path":"/home/guzz/Apps/feathers-micro/packages/serverless/src/middleware.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":0},"end":{"line":12,"column":31}},"14":{"start":{"line":13,"column":22},"end":{"line":25,"column":2}},"15":{"start":{"line":13,"column":56},"end":{"line":25,"column":2}},"16":{"start":{"line":14,"column":4},"end":{"line":23,"column":5}},"17":{"start":{"line":14,"column":17},"end":{"line":14,"column":18}},"18":{"start":{"line":15,"column":27},"end":{"line":15,"column":41}},"19":{"start":{"line":16,"column":8},"end":{"line":21,"column":9}},"20":{"start":{"line":17,"column":12},"end":{"line":20,"column":14}},"21":{"start":{"line":22,"column":8},"end":{"line":22,"column":42}},"22":{"start":{"line":24,"column":4},"end":{"line":24,"column":18}},"23":{"start":{"line":26,"column":0},"end":{"line":26,"column":38}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":13,"column":22},"end":{"line":13,"column":23}},"loc":{"start":{"line":13,"column":56},"end":{"line":25,"column":2}},"line":13},"8":{"name":"(anonymous_8)","decl":{"start":{"line":13,"column":90},"end":{"line":13,"column":91}},"loc":{"start":{"line":13,"column":103},"end":{"line":25,"column":1}},"line":13}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":16,"column":8},"end":{"line":21,"column":9}},"type":"if","locations":[{"start":{"line":16,"column":8},"end":{"line":21,"column":9}},{"start":{"line":16,"column":8},"end":{"line":21,"column":9}}],"line":16}},"s":{"0":1,"1":1,"2":0,"3":8,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":8,"11":8,"12":1,"13":1,"14":1,"15":8,"16":8,"17":8,"18":2,"19":2,"20":1,"21":1,"22":7,"23":1},"f":{"0":8,"1":1,"2":0,"3":8,"4":1,"5":0,"6":8,"7":8,"8":8},"b":{"0":[1,1,1],"1":[1,0],"2":[8,8],"3":[7,1],"4":[8,8],"5":[1,1]},"inputSourceMap":{"version":3,"file":"/home/guzz/Apps/feathers-micro/packages/serverless/src/middleware.ts","sources":["/home/guzz/Apps/feathers-micro/packages/serverless/src/middleware.ts"],"names":[],"mappings":";;;;;;;;;;;;AAEO,MAAM,aAAa,GAAG,CAC3B,OAAmC,EACnC,MAAwB,EACxB,WAAyB,EACL,EAAE;IACtB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;QAC3C,MAAM,UAAU,GAAG,WAAW,CAAC,CAAC,CAAC,CAAA;QACjC,IAAI,OAAO,UAAU,KAAK,UAAU,EAAE;YACpC,MAAM;gBACJ,UAAU,EAAE,GAAG;gBACf,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,KAAK,EAAE,cAAc,CAAC,oBAAoB,EAAE,CAAC;aACrE,CAAA;SACF;QACD,MAAM,UAAU,CAAC,OAAO,EAAE,MAAM,CAAC,CAAA;KAClC;IACD,OAAO,MAAM,CAAA;AACf,CAAC,CAAA,CAAA;AAhBY,QAAA,aAAa,iBAgBzB","sourcesContent":["import { Middleware, ServerlessMiddlewareParams, ServerlessParams, MiddlewareResponse } from './declarations'\n\nexport const runMiddleware = async (\n  context: ServerlessMiddlewareParams,\n  params: ServerlessParams,\n  middlewares: Middleware[]\n): MiddlewareResponse => {\n  for (let i = 0; middlewares.length > i; i++) {\n    const middleware = middlewares[i]\n    if (typeof middleware !== 'function') {\n      throw {\n        statusCode: 500,\n        body: JSON.stringify({ error: `Middleware ${i} is not a function` })\n      }\n    }\n    await middleware(context, params)\n  }\n  return params\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"06acffd226301a310cba9818de09a11da74c6b7d","contentHash":"a95d4fa9ae7e57a68eab67d3e7813e8d83b979bcbdca9a81cffc26ecae0e6fad"},"/home/guzz/Apps/feathers-micro/packages/serverless/src/authentication.ts":{"path":"/home/guzz/Apps/feathers-micro/packages/serverless/src/authentication.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":0},"end":{"line":11,"column":62}},"13":{"start":{"line":12,"column":0},"end":{"line":12,"column":41}},"14":{"start":{"line":13,"column":32},"end":{"line":28,"column":2}},"15":{"start":{"line":13,"column":92},"end":{"line":28,"column":2}},"16":{"start":{"line":15,"column":24},"end":{"line":15,"column":44}},"17":{"start":{"line":16,"column":20},"end":{"line":16,"column":52}},"18":{"start":{"line":17,"column":4},"end":{"line":19,"column":5}},"19":{"start":{"line":18,"column":8},"end":{"line":18,"column":57}},"20":{"start":{"line":20,"column":25},"end":{"line":20,"column":100}},"21":{"start":{"line":21,"column":24},"end":{"line":21,"column":139}},"22":{"start":{"line":22,"column":27},"end":{"line":22,"column":119}},"23":{"start":{"line":23,"column":4},"end":{"line":26,"column":5}},"24":{"start":{"line":24,"column":31},"end":{"line":24,"column":90}},"25":{"start":{"line":25,"column":8},"end":{"line":25,"column":52}},"26":{"start":{"line":27,"column":4},"end":{"line":27,"column":23}},"27":{"start":{"line":29,"column":0},"end":{"line":29,"column":58}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":13,"column":32},"end":{"line":13,"column":33}},"loc":{"start":{"line":13,"column":92},"end":{"line":28,"column":2}},"line":13},"8":{"name":"(anonymous_8)","decl":{"start":{"line":13,"column":126},"end":{"line":13,"column":127}},"loc":{"start":{"line":13,"column":139},"end":{"line":28,"column":1}},"line":13}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":13,"column":53},"end":{"line":13,"column":87}},"type":"default-arg","locations":[{"start":{"line":13,"column":71},"end":{"line":13,"column":87}}],"line":13},"6":{"loc":{"start":{"line":17,"column":4},"end":{"line":19,"column":5}},"type":"if","locations":[{"start":{"line":17,"column":4},"end":{"line":19,"column":5}},{"start":{"line":17,"column":4},"end":{"line":19,"column":5}}],"line":17},"7":{"loc":{"start":{"line":20,"column":25},"end":{"line":20,"column":100}},"type":"cond-expr","locations":[{"start":{"line":20,"column":93},"end":{"line":20,"column":95}},{"start":{"line":20,"column":98},"end":{"line":20,"column":100}}],"line":20},"8":{"loc":{"start":{"line":20,"column":25},"end":{"line":20,"column":90}},"type":"binary-expr","locations":[{"start":{"line":20,"column":25},"end":{"line":20,"column":73}},{"start":{"line":20,"column":77},"end":{"line":20,"column":90}}],"line":20},"9":{"loc":{"start":{"line":21,"column":24},"end":{"line":21,"column":139}},"type":"cond-expr","locations":[{"start":{"line":21,"column":93},"end":{"line":21,"column":99}},{"start":{"line":21,"column":102},"end":{"line":21,"column":139}}],"line":21},"10":{"loc":{"start":{"line":21,"column":24},"end":{"line":21,"column":90}},"type":"binary-expr","locations":[{"start":{"line":21,"column":24},"end":{"line":21,"column":73}},{"start":{"line":21,"column":77},"end":{"line":21,"column":90}}],"line":21},"11":{"loc":{"start":{"line":22,"column":27},"end":{"line":22,"column":119}},"type":"binary-expr","locations":[{"start":{"line":22,"column":27},"end":{"line":22,"column":50}},{"start":{"line":22,"column":54},"end":{"line":22,"column":82}},{"start":{"line":22,"column":86},"end":{"line":22,"column":113}},{"start":{"line":22,"column":117},"end":{"line":22,"column":119}}],"line":22},"12":{"loc":{"start":{"line":23,"column":4},"end":{"line":26,"column":5}},"type":"if","locations":[{"start":{"line":23,"column":4},"end":{"line":26,"column":5}},{"start":{"line":23,"column":4},"end":{"line":26,"column":5}}],"line":23},"13":{"loc":{"start":{"line":23,"column":8},"end":{"line":23,"column":64}},"type":"binary-expr","locations":[{"start":{"line":23,"column":8},"end":{"line":23,"column":33}},{"start":{"line":23,"column":37},"end":{"line":23,"column":48}},{"start":{"line":23,"column":52},"end":{"line":23,"column":64}}],"line":23}},"s":{"0":1,"1":8,"2":0,"3":8,"4":8,"5":8,"6":0,"7":0,"8":0,"9":0,"10":16,"11":8,"12":1,"13":1,"14":1,"15":8,"16":8,"17":8,"18":8,"19":1,"20":8,"21":8,"22":8,"23":8,"24":8,"25":8,"26":8,"27":1},"f":{"0":8,"1":8,"2":0,"3":8,"4":8,"5":0,"6":16,"7":8,"8":8},"b":{"0":[1,1,1],"1":[8,0],"2":[8,8],"3":[8,8],"4":[8,8],"5":[8],"6":[1,7],"7":[8,0],"8":[8,8],"9":[0,8],"10":[8,8],"11":[8,8,0,0],"12":[8,0],"13":[8,8,8]},"inputSourceMap":{"version":3,"file":"/home/guzz/Apps/feathers-micro/packages/serverless/src/authentication.ts","sources":["/home/guzz/Apps/feathers-micro/packages/serverless/src/authentication.ts"],"names":[],"mappings":";;;;;;;;;;;;AAIO,MAAM,uBAAuB,GAAG,CACrC,WAAgC,EAChC,KAA2B,EAC3B,kBAA0B,gBAAgB,EAC1C,EAAE;;IACF,MAAM,WAAW,GAAG,EAAE,QAAQ,EAAE,MAAM,EAGrC,CAAA;IACD,MAAM,OAAO,qBAAQ,KAAK,CAAC,OAAO,CAAE,CAAA;IACpC,IAAI,OAAO,CAAC,eAAe,CAAC,EAAE;QAC5B,OAAO,CAAC,aAAa,GAAG,OAAO,CAAC,eAAe,CAAC,CAAA;KACjD;IACD,MAAM,YAAY,GAAG,MAAA,WAAW,CAAC,GAAG,CAAC,eAAe,CAAC,mCAAI,EAAE,CAAA;IAE3D,MAAM,WAAW,GAAG,MAAA,WAAW,CAAC,qBAAqB,4DAAG,eAAe,CAAC,CAAA;IAExE,MAAM,cAAc,GAClB,YAAY,CAAC,UAAU,IAAI,YAAY,CAAC,eAAe,IAAI,YAAY,CAAC,cAAc,IAAI,EAAE,CAAA;IAE9F,IAAI,cAAc,CAAC,MAAM,GAAG,CAAC,IAAI,WAAW,IAAI,YAAY,EAAE;QAC5D,MAAM,cAAc,GAAG,MAAM,WAAW,CAAC,KAAK,CAC5C,EAAE,OAAO,EAAqB,EAC9B,EAAoB,EACpB,GAAG,cAAc,CAClB,CAAA;QACD,WAAW,CAAC,cAAc,GAAG,cAAc,CAAA;KAC5C;IACD,OAAO,WAAW,CAAA;AACpB,CAAC,CAAA,CAAA;AA7BY,QAAA,uBAAuB,2BA6BnC","sourcesContent":["import { IncomingMessage, ServerResponse } from 'http'\nimport { AuthenticationRequest } from '@feathersjs/authentication/lib'\nimport { APIGatewayProxyEvent, FeathersApplication } from './declarations'\n\nexport const configureAuthentication = async (\n  feathersApp: FeathersApplication,\n  event: APIGatewayProxyEvent,\n  authServicePath: string = 'authentication'\n) => {\n  const extraParams = { provider: 'rest' } as {\n    authentication: AuthenticationRequest\n    provider: 'rest'\n  }\n  const headers = { ...event.headers }\n  if (headers['Authorization']) {\n    headers.authorization = headers['Authorization']\n  }\n  const authSettings = feathersApp.get(authServicePath) ?? {}\n\n  const authService = feathersApp.defaultAuthentication?.(authServicePath)\n\n  const authStrategies =\n    authSettings.strategies || authSettings.parseStrategies || authSettings.authStrategies || []\n\n  if (authStrategies.length > 0 && authService && authSettings) {\n    const authentication = await authService.parse(\n      { headers } as IncomingMessage,\n      {} as ServerResponse,\n      ...authStrategies\n    )\n    extraParams.authentication = authentication\n  }\n  return extraParams\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2ac837e2c88e050aa27f033b652c1d104a27c6e7","contentHash":"b223b13e33e243520a488330c6828cd887fbd9161ab109a3911f53c950499808"},"/home/guzz/Apps/feathers-micro/packages/serverless/src/declarations.ts":{"path":"/home/guzz/Apps/feathers-micro/packages/serverless/src/declarations.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}}},"fnMap":{},"branchMap":{},"s":{"0":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"/home/guzz/Apps/feathers-micro/packages/serverless/src/declarations.ts","sources":["/home/guzz/Apps/feathers-micro/packages/serverless/src/declarations.ts"],"names":[],"mappings":"","sourcesContent":["import { Application as FeathersApplication, Query } from '@feathersjs/feathers'\nimport {\n  APIGatewayProxyHandler,\n  APIGatewayProxyEvent,\n  Context as LambdaContext,\n  APIGatewayProxyResult,\n  Callback\n} from 'aws-lambda'\n// Externals\nexport { FeathersApplication, Query }\nexport { APIGatewayProxyHandler, APIGatewayProxyEvent, LambdaContext }\nexport type ServerlessGatewayProxyEvent = Pick<\nAPIGatewayProxyEvent,\n'httpMethod' | 'body' | 'path' | 'queryStringParameters' | 'headers' | 'resource'\n>\n// Helpers\nimport { FeathersMethod, HttpMethod } from './methods'\nexport type Maybe<T> = T | undefined | null\nexport type BodyPropertiesValues =\n  | string\n  | number\n  | boolean\n  | Array<BodyPropertiesValues>\n  | BodyProperties\n  | ((...args: BodyPropertiesValues[]) => unknown)\nexport type BodyProperties = { [key: string]: BodyPropertiesValues }\ntype HttpMethodType = typeof HttpMethod\ntype HttpMethodKeys = keyof HttpMethodType\nexport type HttpMethodValues = (typeof HttpMethod)[HttpMethodKeys]\ntype FeathersMethodType = typeof FeathersMethod\ntype FeathersMethodKeys = keyof FeathersMethodType\nexport type FeathersMethodValues = (typeof FeathersMethod)[FeathersMethodKeys]\n// Middleware\nexport type ServerlessParams = {\n  body: BodyProperties\n  method: FeathersMethodValues\n  serviceName: string\n  feathersId: string\n  query: Query\n  args: unknown\n  feathersMethod: FeathersMethodValues\n  getParamsFromBody: boolean\n}\nexport type ServerlessMiddlewareParams = {\n  event: ServerlessGatewayProxyEvent\n  cb: Callback<APIGatewayProxyResult>\n  feathersApp: FeathersApplication\n}\nexport type MiddlewareResponse = Promise<ServerlessParams | APIGatewayProxyResult | void>\nexport type Middleware = (ctx: ServerlessMiddlewareParams, params: ServerlessParams) => MiddlewareResponse\n// Application\nexport interface ServerlessApplication {\n  variables?: BodyProperties\n  handler: () => APIGatewayProxyHandler\n}\nexport type Application<Services = any, Settings = any> = FeathersApplication<Services, Settings > & ServerlessApplication"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b8ef8cc65becd6f9c8ab7146d3bd62d551c8d67b","contentHash":"5e9add233e6efc8bc1b10e4e7c7cd4f1115c1b66552597e14022cf86f8c41c89"}}